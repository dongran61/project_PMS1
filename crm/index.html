<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>营销管理</title>
    <link rel="stylesheet" href="../assets/layui/css/layui.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="css/css.css">
    <link href="css/left.css" rel="stylesheet"/>
</head>
<body>
<div id="left" class="layui-side layui-bg-black layui-anim layui-anim-upbit layui-form">

    <div class="layui-side-scroll">
        <ul class="layui-nav layui-nav-tree" lay-filter="test">
            <li class="layui-nav-item">
                <a class="flex_row_l" href="javascript:;"><span class="icon icon_FacM"></span>企业客户管理</a>
                <dl class="layui-nav-child dl_nav_2">
                    <dd>
                        <a class="nav_2 show" href="javascript:;">
                            <span class="layui-icon layui-icon-triangle-r"></span>
                            <span class="line"></span>
                            <span class="font">公司协议</span>
                        </a>
                    </dd>
                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">团队旅行社</span></a>
                    </dd>

                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">订房中心/OTA</span></a>
                    </dd>
                </dl>
            </li>
            <li class="layui-nav-item">
                <a class="flex_row_l" href="javascript:;"><span class="icon icon_saleM"></span>销售管理</a>
                <dl class="layui-nav-child dl_nav_2">
                    <dd>
                        <a class="nav_2 show" href="javascript:;">
                            <span class="layui-icon layui-icon-triangle-r"></span>
                            <span class="line"></span>
                            <span class="font">公司协议</span>
                        </a>
                    </dd>
                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">团队旅行社</span></a>
                    </dd>

                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">订房中心/OTA</span></a>
                    </dd>
                </dl>
            </li>
        </ul>
    </div>
</div>
<div id="layui-body" class="layui-body" style="border: none">

    <div class="page_panel relative">

        <div class="layui-row">
            <div class="layui-row">
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4  layui-col-lg3 btn_panel flex_row">
                    <button class="btn_base btn_delete flex_row" data-type="delete"><i class="icon"></i>删除</button>
                    <button class="btn_base btn_search flex_row active" data-type="search"><i class="icon"></i>查询</button>
                    <button class="btn_base btn_edit flex_row" data-type="edit"><i class="icon"></i>修改</button>
                    <button class="btn_base btn_add flex_row" data-type="add"><i class="icon"></i>新增</button>
                    <input id="btnStatus" type="hidden" value="0"/>
                    <!--0为查询-->
                    <!--1为修改-->
                    <!--2为新增-->
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-xs4 layui-col-sm4 layui-col-md4  layui-col-lg3 setting_left">
                    <form id="form_yx" class="layui-form hide" action="" lay-filter="setting">

                        <div class="layui-form-item">
                            <label class="layui-form-label">类别</label>
                            <div class="layui-input-block">
                                <select name="category">
                                    <option value="">请选择</option>
                                    <option value="公司协议">公司协议</option>
                                    <option value="团队旅行社">团队旅行社</option>
                                    <option value="订房中心/OTA">订房中心/OTA</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">单位名称</label>
                            <div class="layui-input-block">
                                <input name="facName" type="text" placeholder="单位名称" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>


                        <div class="layui-form-item">
                            <label class="layui-form-label">地址</label>
                            <div class="layui-input-block">
                                <input name="address" type="text" placeholder="地址" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">联系人</label>
                            <div class="layui-input-block">
                                <input name="contacts" type="text" placeholder="请输入联系人" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">手机</label>
                            <div class="layui-input-block">
                                <input id="txtPhone" name="mobile" type="text" lay-verify="phone"
                                       placeholder="请输入联系电话" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">公司电话</label>
                            <div class="layui-input-block">
                                <input type="text" name="phone" placeholder="请输入公司电话" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">发展途径</label>
                            <div class="layui-input-block">
                                <select name="developmentWay">
                                    <option value="">请选择</option>
                                    <option value="酒店销售">酒店销售</option>
                                    <option value="城区销售">城区销售</option>
                                    <option value="集团销售">集团销售</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">销售员</label>
                            <div class="layui-input-block">
                                <input name="saleName" type="text" placeholder="请输入销售员" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">房价码</label>
                            <div class="layui-input-block">
                                <select name="roomCode">
                                    <option value="">请选择</option>
                                    <option value="COR85">COR85</option>
                                    <option value="COR84">COR84</option>
                                    <option value="COR86">COR86</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">佣金码</label>
                            <div class="layui-input-block">
                                <select name="commissionCode">
                                    <option value="">请选择</option>
                                    <option value="COR85">COR85</option>
                                    <option value="COR84">COR84</option>
                                    <option value="COR86">COR86</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">有效日期</label>
                            <div class="layui-input-block">
                                <input id="txtDate" name="effectiveDate" type="text" placeholder="开始日期 - 结束日期"
                                       autocomplete="off" class="layui-input dateRange">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">协议性质</label>
                            <div class="layui-input-block">
                                <select name="agreement">
                                    <option value="">请选择</option>
                                    <option value="单店协议">单店协议</option>
                                    <option value="城区协议">城区协议</option>
                                    <option value="集团协议">集团协议</option>
                                </select>
                            </div>
                        </div>
                        <!--
                        <div class="layui-form-item">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-block">

                                <input type="radio" id="rdo_ok_1" name="rdo_ok" value="0" lay-skin="primary" title="启用">
                                <input type="radio" id="rdo_ok_2" name="rdo_ok" value="1" lay-skin="primary" title="停用">

                            </div>
                        </div>
                        -->
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button type="reset" class="layui-btn layui-btn-primary">清空</button>
                                <button class="layui-btn" lay-submit lay-filter="formDemo">确定</button>

                            </div>
                        </div>
                    </form>
                    <form id="form_yx_search" class="layui-form" action="" lay-filter="settingSearch">

                        <div class="layui-form-item">
                            <label class="layui-form-label">类别</label>
                            <div class="layui-input-block">
                                <select name="">
                                    <option value="">请选择</option>
                                    <option value="公司协议">公司协议</option>
                                    <option value="团队旅行社">团队旅行社</option>
                                    <option value="订房中心/OTA">订房中心/OTA</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">单位名称</label>
                            <div class="layui-input-block">
                                <input name="" type="text" placeholder="单位名称" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>



                        <div class="layui-form-item">
                            <label class="layui-form-label">销售员</label>
                            <div class="layui-input-block">
                                <input name="" type="text" placeholder="请输入销售员" autocomplete="off"
                                       class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">状态</label>
                            <div class="layui-input-block">
                                <select name="roomCode">
                                    <option value="">请选择</option>
                                    <option value="有效">有效</option>
                                    <option value="审核">审核</option>
                                    <option value="过期">过期</option>
                                </select>
                            </div>
                        </div>


                        <div class="layui-form-item">
                            <label class="layui-form-label">房价码</label>
                            <div class="layui-input-block">
                                <select name="roomCode">
                                    <option value="">请选择</option>
                                    <option value="COR85">COR85</option>
                                    <option value="COR84">COR84</option>
                                    <option value="COR86">COR86</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">佣金码</label>
                            <div class="layui-input-block">
                                <select name="">
                                    <option value="">请选择</option>
                                    <option value="COR85">COR85</option>
                                    <option value="COR84">COR84</option>
                                    <option value="COR86">COR86</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">创建日期</label>
                            <div class="layui-input-block">
                                <input id="txtDateCreate" type="text" placeholder="开始日期 - 结束日期"
                                       autocomplete="off" class="layui-input dateRange">
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">协议性质</label>
                            <div class="layui-input-block">
                                <select name="">
                                    <option value="">请选择</option>
                                    <option value="单店协议">单店协议</option>
                                    <option value="城区协议">城区协议</option>
                                    <option value="集团协议">集团协议</option>
                                </select>
                            </div>
                        </div>
                        <!--
                        <div class="layui-form-item">
                            <label class="layui-form-label"></label>
                            <div class="layui-input-block">

                                <input type="radio" id="rdo_ok_1" name="rdo_ok" value="0" lay-skin="primary" title="启用">
                                <input type="radio" id="rdo_ok_2" name="rdo_ok" value="1" lay-skin="primary" title="停用">

                            </div>
                        </div>
                        -->
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button type="reset" class="layui-btn layui-btn-primary">清空</button>
                                <button class="layui-btn" lay-submit lay-filter="formDemo">确定</button>

                            </div>
                        </div>
                    </form>
                </div>
                <div class="layui-col-xs8 layui-col-sm8 layui-col-md8  layui-col-lg9 " style="padding: 0">
                    <div class="setting_right">
                        <table class="layui-table"
                               lay-data="{height: 'full-100', url:'../json/marketingManagement.json', page:false}"
                               lay-filter="user">
                            <thead>
                            <tr>
                                <th lay-data="{field:'facName'}">公司名称</th>
                                <th lay-data="{field:'roomCode'}">房价码</th>
                                <th lay-data="{field:'commissionCode'}">佣金码</th>
                                <th lay-data="{field:'effectiveEndDate',style:'color:#858DA2'}">有效截止时间</th>
                                <th lay-data="{field:'agreement',style:'color:#858DA2'}">协议性质</th>

                                <!--<th lay-data="{fixed: 'status',align:'center', toolbar: '#statusTpl'}">状态</th>-->
                                <th lay-data="{field:'status', templet: '#barOperation',align:'center',style:'text-align: center'}">
                                    状态
                                </th>
                                <th lay-data="{field:'createDate',style:'color:#858DA2'}">创建日期</th>
                                <th lay-data="{field:'saleName'}">销售员</th>

                            </tr>

                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>
<div class="popup_box_1">
    <div id="popup_fac" class="popup" style="display: none">
        <div class="layui-form">
            <div class="layui-row listInfo">
                <table class=" layui-table"
                       lay-data="{height: 'full', url:'../json/financialProcessing.json', page:false}"
                       lay-filter="searchList">
                    <thead>
                    <tr>
                        <th lay-data="{field:'roomNum',width:150}">账号</th>
                        <th lay-data="{field:'daima',width:120}">入住人</th>
                        <th lay-data="{field:'roomNum',width:150}">协议单位</th>
                        <th lay-data="{field:'daima',width:120}">到店日期</th>
                        <th lay-data="{field:'roomNum',width:120}">离店日期</th>
                        <th lay-data="{field:'daima',width:120}">房号</th>
                        <th lay-data="{field:'roomNum',width:150}">房类</th>
                        <th lay-data="{field:'daima',width:120}">房价</th>
                        <th lay-data="{field:'daima',width:120}">房晚</th>
                        <th lay-data="{field:'roomNum',width:150}">房费</th>
                        <th lay-data="{field:'daima',width:150}">其他</th>
                        <th lay-data="{field:'daima',width:120}">合计</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="barOperation">
    <!--<a class="layui-btn  layui-btn-xs btn_orange" lay-event="reset">重置密码</a>-->
    {{#  if(d.status == '审核中'){ }}
    <a class="layui-btn  layui-btn-xs btn_blue" lay-event="">审核中</a>
    {{#  } else if(d.status == '不通过'){ }}
    <a class="layui-btn  layui-btn-xs btn_orange" lay-event="">不通过</a>
    {{#  } else if(d.status == '有效'){ }}
    <a class="layui-btn  layui-btn-xs btn_green" lay-event="">有效</a>
    {{#  } else if(d.status == '过期'){ }}
    <a class="layui-btn  layui-btn-xs btn_gray" lay-event="">过期</a>
    {{#  } else if(d.status == '申请审核'){ }}
    <a class="layui-btn  layui-btn-xs btn_blue" lay-event="shenhe">申请审核</a>
    {{#  } }}
</script>

<script src="../assets/layui/layui.js" charset="utf-8"></script>
<script>
    //JavaScript代码区域
    layui.use(['element', 'laydate', 'form', 'table', 'layer'], function () {
        var element = layui.element, $ = layui.jquery, form = layui.form, table = layui.table, laydate = layui.laydate;
        var $ = layui.$, active = {
            search: function () { //获取搜索数据
                $("#btnStatus").val("0")
                $("#form_yx").addClass("hide")
                $("#form_yx_search").removeClass("hide")
            }
            , edit: function () { //编辑
                $("#btnStatus").val("1")
                $("#form_yx_search").addClass("hide")
                $("#form_yx").removeClass("hide")
            }
            , add: function () { //新增
                $("#btnStatus").val("2")
                $("#form_yx_search").addClass("hide")
                $("#form_yx").removeClass("hide")
            }
        };
//日期范围
        laydate.render({
            elem: '#txtDate'
            , range: true
            , format: 'yyyy/MM/dd'
            , trigger: 'click'
        });

        $('.btn_base').on('click', function () {
            var type = $(this).data('type');
            $(".btn_base").removeClass("active")
            active[type] ? active[type].call(this) : '';
            $(this).addClass("active")
        });

        //监听提交
        form.on('submit(setting)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });


        //监听工具条
        table.on('tool(user)', function (obj) {
            var data = obj.data;
            // layer.msg('obj.event:' + obj.event);
            if (obj.event === 'shenhe') {
               // layer.msg('ID：' + data.name + ' 的重置密码操作');

                layer.open({
                    type: 1
                    ,content: '<div style="padding: 20px 100px;">是否通过审核？</div>'
                    ,btn: ['通过','不通过']
                    ,btnAlign: 'c' //按钮居中
                    ,yes: function(){
                        console.log("通过操作")
                        layer.closeAll();
                    }
                });
            }
        });


        table.on('rowDouble(user)', function (obj) {
            if ($("#btnStatus").val() == "1") {
                console.log(obj.data) //得到当前行数据
                form.val('setting', {
                    "category": obj.data.category
                    , "facName": obj.data.facName
                    , "saleName": obj.data.saleName
                    , "roomCode": obj.data.roomCode
                    , "commissionCode": obj.data.commissionCode
                    , "agreement": obj.data.agreement
                    , "effectiveDate": obj.data.effectiveStartDate + " - " + obj.data.effectiveEndDate
                    , "createDate": obj.data.createDate
                    , "mobile": obj.data.mobile
                    , "phone": obj.data.phone
                    , "contacts": obj.data.contacts
                    , "address": obj.data.address
                    , "developmentWay": obj.data.developmentWay

                });
                $("input[name='rdo_ok']").each(function (i) {
                    if ($(this).attr("checked")) {
                        $(this).next().addClass("layui-form-radioed")
                        $(this).next().html('<i class="layui-anim layui-icon layui-anim-scaleSpring"></i><div>' + $(this).attr("title") + '</div>')
                    }
                })
                /* */
                // form.render(); //更新全部
                obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');

            }
            else{
                layer.open({
                    type: 1,
                    title:"企业客户消费明细表",
                    content: $('#popup_fac') //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
                });
            }
        });
    });
</script>
</body>
</html>