<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>营销活动</title>
    <link rel="stylesheet" href="../assets/layui/css/layui.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="css/css.css">
    <link href="css/left.css" rel="stylesheet"/>
</head>
<body>
<div id="left" class="layui-side layui-bg-black layui-anim layui-anim-upbit layui-form">

    <div class="layui-side-scroll">
        <ul class="layui-nav layui-nav-tree" lay-filter="test">
            <li class="layui-nav-item">
                <a class="flex_row_l" href="javascript:;"><span class="icon icon_FacM"></span>企业客户管理</a>
                <dl class="layui-nav-child dl_nav_2">
                    <dd>
                        <a class="nav_2 show" href="javascript:;">
                            <span class="layui-icon layui-icon-triangle-r"></span>
                            <span class="line"></span>
                            <span class="font">公司协议</span>
                        </a>
                    </dd>
                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">团队旅行社</span></a>
                    </dd>

                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">订房中心/OTA</span></a>
                    </dd>
                </dl>
            </li>
            <li class="layui-nav-item">
                <a class="flex_row_l" href="javascript:;"><span class="icon icon_saleM"></span>销售管理</a>
                <dl class="layui-nav-child dl_nav_2">
                    <dd>
                        <a class="nav_2 show" href="javascript:;">
                            <span class="layui-icon layui-icon-triangle-r"></span>
                            <span class="line"></span>
                            <span class="font">公司协议</span>
                        </a>
                    </dd>
                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">团队旅行社</span></a>
                    </dd>

                    <dd>
                        <a class="nav_2 " href=""><span class="line"></span><span class="font">订房中心/OTA</span></a>
                    </dd>
                </dl>
            </li>
        </ul>
    </div>
</div>
<div id="layui-body" class="layui-body" style="border: none">

    <div class="page_panel relative">


        <div class="layui-form-item layui-form">
            <div class="layui-inline ">
                <label class="layui-form-label">类别</label>
                <div class="layui-input-inline">
                    <select>
                        <option value="">请选择</option>
                        <option value="1">线上</option>
                        <option value="2">线下</option>

                    </select>
                </div>
            </div>
            <div class="layui-inline ">
                <label class="layui-form-label">范围</label>
                <div class="layui-input-inline">
                    <select>
                        <option value="">请选择</option>
                        <option value="1">单店</option>
                        <option value="2">城区</option>
                        <option value="3">集团</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">活动名称</label>
                <div class="layui-input-inline">
                    <input type="text" name="url" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">状态</label>
                <div class="layui-input-inline">
                    <select>
                        <option value="">请选择</option>
                        <option value="1">有效</option>
                        <option value="2">审核</option>
                        <option value="3">过期</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <button type="button" class="btn_base2 bg_58759B"><i class="layui-icon layui-icon-search"></i>查询
                </button>
            </div>
        </div>
        <div class="layui-row">

            <div class="layui-col-xs12 layui-col-sm12 layui-col-md12  layui-col-lg12 " style="padding: 0">
                <div class="setting_right">
                    <div class="layui-row">

                    </div>
                    <table class="layui-table"
                           lay-data="{height: 'full', url:'../json/marketingManagement.json', page:false}"
                           lay-filter="user">
                        <thead>
                        <tr>
                            <th lay-data="{field:'roomCode',width:140,}">类别</th>
                            <th lay-data="{field:'commissionCode',width:140}">范围</th>
                            <th lay-data="{field:'facName',width:140}">活动名称</th>
                            <th lay-data="{field:'effectiveEndDate',style:'color:#858DA2',width:140}">开始时间</th>
                            <th lay-data="{field:'effectiveEndDate',style:'color:#858DA2',width:140}">结束时间</th>

                            <th lay-data="{field:'status', templet: '#barOperation',align:'center',style:'text-align: center',width:140}">
                                状态
                            </th>
                            <th lay-data="{field:'createDate',style:'color:#858DA2',width:140}">创建日期</th>
                            <th lay-data="{field:'saleName',width:140}">创建人</th>

                            <th lay-data="{field:'status', templet: '#barSetting',align:'center',style:'text-align: center',width:140}">
                                设置规则
                            </th>
                        </tr>

                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


</div>
<div class="popup_box_1">
    <div id="popup_fac" class="popup" style="display: none">
        <div class="layui-form">
            <div class="layui-row listInfo">
                <table class=" layui-table"
                       lay-data="{height: 'full', url:'../json/financialProcessing.json', page:false}"
                       lay-filter="searchList">
                    <thead>
                    <tr>
                        <th lay-data="{field:'roomNum',width:150}">账号</th>
                        <th lay-data="{field:'daima',width:120}">入住人</th>
                        <th lay-data="{field:'roomNum',width:150}">协议单位</th>
                        <th lay-data="{field:'daima',width:120}">到店日期</th>
                        <th lay-data="{field:'roomNum',width:120}">离店日期</th>
                        <th lay-data="{field:'daima',width:120}">房号</th>
                        <th lay-data="{field:'roomNum',width:150}">房类</th>
                        <th lay-data="{field:'daima',width:120}">房价</th>
                        <th lay-data="{field:'daima',width:120}">房晚</th>
                        <th lay-data="{field:'roomNum',width:150}">房费</th>
                        <th lay-data="{field:'daima',width:150}">其他</th>
                        <th lay-data="{field:'daima',width:120}">合计</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="barOperation">
    {{#  if(d.status == '审核中'){ }}
    <a class="layui-btn  layui-btn-xs btn_blue" lay-event="list_canel">已报名</a>
    {{#  } else if(d.status == '不通过'){ }}
    <a class="layui-btn  layui-btn-xs btn_orange" lay-event="list_ok">未报名</a>
    {{#  } else if(d.status == '过期'){ }}
    <a class="layui-btn  layui-btn-xs btn_gray" lay-event="">已过期</a>
    {{#  } }}
</script>
<script type="text/html" id="barSetting">

    {{#  if(d.status == '过期'){ }}
    <em class="font_D1D3DA">设置规则</em>
    {{#  } else{ }}
     <a class="layui-btn  layui-btn-xs " lay-event="set">设置规则</a>
    {{#  } }}
</script>
<script type="text/html" id="barClose">

    <a class="layui-btn layui-btn-xs btn_orange" lay-event="list_close">关闭</a>
</script>
<div class="popup_box_1">
    <div id="popup_cyl" class="popup" style="display: none">
        <div class="layui-form">
            <div class="layui-row flex_row_l">
                <div class="layui-form-item layui-col-sm3 layui-col-md3 layui-col-lg3">
                    <label class="layui-form-label">开始日期：</label>
                    <div class="layui-input-block flex_row_l">
                        <input type="text" class="layui-input date_item" placeholder="开始日期">
                    </div>
                </div>
                <div class="layui-form-item layui-col-sm3 layui-col-md3 layui-col-lg3">
                    <label class="layui-form-label">结束日期：</label>
                    <div class="layui-input-block flex_row_l">
                        <input type="text" class="layui-input date_item" placeholder="结束日期">
                    </div>
                </div>
                <div class="layui-form-item layui-col-sm3 layui-col-md3 layui-col-lg3 layui-form-item-xs">
                    <label class="layui-form-label ">房型：</label>
                    <div class="layui-input-block flex_row_l">
                        <select name="dataJurisdiction" lay-verify="required">
                            <option value="">请选择</option>
                            <option value="行程改变">行程改变行程改变行程改变</option>
                            <option value="行程改变2">行程改变2</option>
                            <option value="行程改变3">行程改变3</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item layui-col-sm3 layui-col-md3 layui-col-lg3 layui-form-item-sm">
                    <label class="layui-form-label">订房数：</label>
                    <div class="layui-input-block flex_row_l">
                        <input type="number" value="20" class="layui-input"/>
                    </div>
                </div>
            </div>
            <div class="layui-row flex_row_l">
                <div class="layui-row layui-row_item  layui-col-sm12 layui-col-md12 layui-col-lg12 ">
                    <label class="layui-form-label">星期：</label>
                    <div class="layui-input-block flex_row_l">
                        <input type="checkbox" name="" lay-skin="primary" title="星期一" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期二" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期三" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期四" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期五" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期六" checked="">
                        <input type="checkbox" name="" lay-skin="primary" title="星期日" checked="">

                    </div>
                </div>
            </div>
            <div class="nav_10"></div>
            <div class="layui-row layui-row_item flex_row_r">


                <div class="layui-row layui-row_item layui-col-sm5 layui-col-md5 layui-col-lg5 flex_row_r">
                    <button type="button" class="btn_base2 btn_fff_blue">退出</button>

                    <button type="button" class="btn_base2 btn_blue">设置</button>

                </div>


            </div>
            <div class="nav_10"></div>
            <div class="layui-row cyl_table">
                <table class=" layui-table"
                       lay-data="{height: 'full', url:'../json/financialProcessing.json', page:false}"
                       lay-filter="settingRules">
                    <thead>
                    <tr>
                        <th lay-data="{field:'yingyeTime',width:'120'}">开始时间</th>
                        <th lay-data="{field:'yewuTime',width:'120'}">结束时间</th>
                        <th lay-data="{field:'price',width:'140'}">星期<!--显示数据为一、二、三、四--></th>
                        <th lay-data="{field:'banci',width:'120'}">房型</th>
                        <th lay-data="{field:'roomNum',width:'80'}">房数</th>

                        <th lay-data="{field:'roomNum',width:'80'}">超订数</th>

                        <th lay-data="{field:'yingyeTime',width:'120'}">设置时间</th>
                        <th lay-data="{field:'caozuoyuan',width:'80'}">设置人</th>
                        <th lay-data="{field:'daima',align:'center', templet: '#barClose',width:'120'}"></th>

                    </tr>
                    </thead>
                </table>
            </div>
            <div class="nav_30"></div>
        </div>
    </div>
</div>

<script src="../assets/layui/layui.js" charset="utf-8"></script>
<script>
    //JavaScript代码区域
    layui.use(['element', 'laydate', 'form', 'table', 'layer'], function () {
        var element = layui.element, $ = layui.jquery, form = layui.form, table = layui.table, laydate = layui.laydate;

        //同时绑定多个
        lay('.date_item').each(function () {
            laydate.render({
                elem: this
                , trigger: 'click'
            });
        });


        //监听提交
        form.on('submit(setting)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });
        table.on('tool(settingRules)', function (obj) {
            if (obj.event === 'list_close') {
                layer.open({
                    type: 1
                    , content: '<div style="padding: 20px 100px;">是否关闭？</div>'
                    , btn: ['是', '否']
                    , btnAlign: 'c' //按钮居中
                    , yes: function () {
                        console.log("是")
                        layer.closeAll();
                    }
                });
            }
        })

        //监听工具条
        table.on('tool(user)', function (obj) {
            var data = obj.data;
            // layer.msg('obj.event:' + obj.event);
            if (obj.event === 'shenhe') {
                // layer.msg('ID：' + data.name + ' 的重置密码操作');

                layer.open({
                    type: 1
                    , content: '<div style="padding: 20px 100px;">是否通过审核？</div>'
                    , btn: ['通过', '不通过']
                    , btnAlign: 'c' //按钮居中
                    , yes: function () {
                        console.log("通过操作")
                        layer.closeAll();
                    }
                });
            }
            else if (obj.event === 'list_canel') {
                layer.open({
                    type: 1
                    , content: '<div style="padding: 20px 100px;">是否取消报名？</div>'
                    , btn: ['是', '否']
                    , btnAlign: 'c' //按钮居中
                    , yes: function () {
                        console.log("是")
                        layer.closeAll();
                    }
                });
            }
            else if (obj.event === 'list_ok') {
                layer.open({
                    type: 1
                    , content: '<div style="padding: 20px 100px;">是否报名？</div>'
                    , btn: ['是', '否']
                    , btnAlign: 'c' //按钮居中
                    , yes: function () {
                        console.log("是")
                        layer.closeAll();
                    }
                });
            }

            else if (obj.event === 'set') {
                layer.open({
                    type: 1,
                    content: $('#popup_cyl'),
                    title: "设置规则"
                });
            }
        });


        table.on('rowDouble(user)', function (obj) {
            if ($("#btnStatus").val() == "1") {
                console.log(obj.data) //得到当前行数据
                form.val('setting', {
                    "category": obj.data.category
                    , "facName": obj.data.facName
                    , "saleName": obj.data.saleName
                    , "roomCode": obj.data.roomCode
                    , "commissionCode": obj.data.commissionCode
                    , "agreement": obj.data.agreement
                    , "effectiveDate": obj.data.effectiveStartDate + " - " + obj.data.effectiveEndDate
                    , "createDate": obj.data.createDate
                    , "mobile": obj.data.mobile
                    , "phone": obj.data.phone
                    , "contacts": obj.data.contacts
                    , "address": obj.data.address
                    , "developmentWay": obj.data.developmentWay

                });
                $("input[name='rdo_ok']").each(function (i) {
                    if ($(this).attr("checked")) {
                        $(this).next().addClass("layui-form-radioed")
                        $(this).next().html('<i class="layui-anim layui-icon layui-anim-scaleSpring"></i><div>' + $(this).attr("title") + '</div>')
                    }
                })
                /* */
                // form.render(); //更新全部
                obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');

            }
            else {
                layer.open({
                    type: 1,
                    title: "企业客户消费明细表",
                    content: $('#popup_fac') //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
                });
            }
        });
    });
</script>
</body>
</html>